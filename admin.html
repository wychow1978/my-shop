<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åº—é“ºåå°ç®¡ç†</title>
    <style>
        body { font-family: sans-serif; padding: 20px; background: #f4f4f4; }
        .container { max-width: 1000px; margin: 0 auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        
        h1 { margin-top: 0; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        
        /* é¡¶éƒ¨å·¥å…·æ  */
        .toolbar { display: flex; gap: 10px; margin-bottom: 20px; }
        input[type="text"], input[type="number"] { padding: 10px; border: 1px solid #ddd; border-radius: 4px; }
        .search-box { flex: 1; }
        
        /* è¡¨æ ¼æ ·å¼ */
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #eee; }
        th { background: #f8f8f8; font-weight: bold; }
        tr:hover { background: #f9f9f9; }
        
        /* çŠ¶æ€æ ‡ç­¾ */
        .status-badge { padding: 4px 8px; border-radius: 4px; font-size: 0.8rem; cursor: pointer; }
        .status-active { background: #e6fffa; color: #00796b; border: 1px solid #b2f5ea; }
        .status-inactive { background: #fff5f5; color: #c53030; border: 1px solid #fed7d7; }

        /* åº•éƒ¨æ“ä½œåŒº */
        .action-area { background: #333; color: white; padding: 20px; border-radius: 8px; margin-top: 20px; }
        textarea { width: 100%; height: 150px; background: #1a1a1a; color: #00ff00; font-family: monospace; padding: 10px; border: none; margin-top: 10px; }
        
        .btn { padding: 10px 20px; cursor: pointer; border: none; border-radius: 4px; font-weight: bold; }
        .btn-add { background: #3182ce; color: white; }
        .btn-save { background: #38a169; color: white; width: 100%; font-size: 1.1rem; }
        .btn-copy { background: #eee; margin-top: 5px; }

        /* æ·»åŠ äº§å“è¡¨å• */
        .add-form { display: grid; grid-template-columns: 1fr 1fr 1fr 1fr auto; gap: 10px; padding: 15px; background: #ebf8ff; border-radius: 8px; margin-bottom: 20px; align-items: end; }
        .form-group label { display: block; font-size: 0.8rem; margin-bottom: 5px; color: #666; }
        .form-group input { width: 100%; box-sizing: border-box; }
    </style>
</head>
<body>

<div class="container">
    <h1>ğŸ“¦ äº§å“åº“ç®¡ç† (Product Sheet)</h1>

    <div class="add-form">
        <div class="form-group">
            <label>ID (å”¯ä¸€ç¼–å·)</label>
            <input type="text" id="newId" placeholder="ä¾‹å¦‚: cup-005">
        </div>
        <div class="form-group">
            <label>äº§å“åç§°</label>
            <input type="text" id="newName" placeholder="äº§å“åå­—">
        </div>
        <div class="form-group">
            <label>ä»·æ ¼ ($)</label>
            <input type="number" id="newPrice" placeholder="25.00">
        </div>
        <div class="form-group">
            <label>å›¾ç‰‡è·¯å¾„</label>
            <input type="text" id="newImg" value="product_images/" placeholder="å›¾ç‰‡æ–‡ä»¶å">
        </div>
        <button class="btn btn-add" onclick="addNewProduct()">+ æ·»åŠ </button>
    </div>

    <div class="toolbar">
        <input type="text" class="search-box" id="searchInput" placeholder="ğŸ” æœç´¢äº§å“åç§°æˆ–ID..." onkeyup="renderTable()">
    </div>

    <table>
        <thead>
            <tr>
                <th>çŠ¶æ€</th>
                <th>ID</th>
                <th>å›¾ç‰‡</th>
                <th>åç§°</th>
                <th>ä»·æ ¼</th>
                <th>æ“ä½œ</th>
            </tr>
        </thead>
        <tbody id="tableBody">
            </tbody>
    </table>

    <div class="action-area">
        <h3>ğŸ’¾ ä¿å­˜æ›´æ”¹</h3>
        <p>1. åœ¨ä¸Šæ–¹ä¿®æ”¹å®Œåï¼Œç‚¹å‡»â€œç”Ÿæˆä»£ç â€ã€‚<br>2. å¤åˆ¶ä»£ç ï¼Œç²˜è´´è¦†ç›–åˆ° <strong>products.js</strong> æ–‡ä»¶ä¸­ã€‚</p>
        <button class="btn btn-save" onclick="generateCode()">ğŸ”„ ç”Ÿæˆæœ€æ–°ä»£ç </button>
        <textarea id="outputCode" readonly onclick="this.select()">æš‚æ—¶æ²¡æœ‰æ›´æ”¹...</textarea>
    </div>
</div>

<script src="products.js"></script>

<script>
    // é¡µé¢åŠ è½½æ—¶ï¼Œä½¿ç”¨ products.js é‡Œçš„ allProducts
    // å¦‚æœ products.js é‡Œæ²¡æœ‰ allProducts (æ—§ç‰ˆæœ¬)ï¼Œå°±ç”¨ç©ºæ•°ç»„
    let currentData = (typeof allProducts !== 'undefined') ? allProducts : [];

    // æ¸²æŸ“è¡¨æ ¼
    function renderTable() {
        const tbody = document.getElementById('tableBody');
        const searchTerm = document.getElementById('searchInput').value.toLowerCase();
        tbody.innerHTML = '';

        currentData.forEach((item, index) => {
            // æœç´¢è¿‡æ»¤
            if (!item.name.toLowerCase().includes(searchTerm) && !item.id.toLowerCase().includes(searchTerm)) {
                return;
            }

            const tr = document.createElement('tr');
            
            // çŠ¶æ€æ ·å¼
            const statusClass = item.active ? 'status-active' : 'status-inactive';
            const statusText = item.active ? 'ä¸Šæ¶ä¸­ (Active)' : 'å·²ä¸‹æ¶ (Inactive)';

            tr.innerHTML = `
                <td><span class="status-badge ${statusClass}" onclick="toggleStatus(${index})">${statusText}</span></td>
                <td>${item.id}</td>
                <td><img src="${item.image}" style="height:40px; border-radius:4px;"></td>
                <td contenteditable="true" onblur="updateName(${index}, this.innerText)">${item.name}</td>
                <td contenteditable="true" onblur="updatePrice(${index}, this.innerText)">$${item.price}</td>
                <td><button onclick="deleteProduct(${index})" style="color:red; border:none; background:none; cursor:pointer;">åˆ é™¤</button></td>
            `;
            tbody.appendChild(tr);
        });
    }

    // 1. åˆ‡æ¢ä¸Šæ¶/ä¸‹æ¶
    function toggleStatus(index) {
        currentData[index].active = !currentData[index].active;
        renderTable();
    }

    // 2. æ·»åŠ æ–°äº§å“
    function addNewProduct() {
        const id = document.getElementById('newId').value;
        const name = document.getElementById('newName').value;
        const price = parseFloat(document.getElementById('newPrice').value);
        const img = document.getElementById('newImg').value;

        if(!id || !name || !price) return alert("è¯·å¡«å†™å®Œæ•´ä¿¡æ¯");

        currentData.push({
            id: id,
            name: name,
            price: price,
            image: img,
            active: true // é»˜è®¤ä¸Šæ¶
        });

        // æ¸…ç©ºè¾“å…¥æ¡†
        document.getElementById('newId').value = '';
        document.getElementById('newName').value = '';
        document.getElementById('newPrice').value = '';
        
        renderTable();
        alert("æ·»åŠ æˆåŠŸï¼è®°å¾—ç‚¹å‡»åº•éƒ¨çš„ç”Ÿæˆä»£ç ã€‚");
    }

    // 3. åˆ é™¤äº§å“
    function deleteProduct(index) {
        if(confirm("ç¡®å®šè¦åˆ é™¤è¿™ä¸ªäº§å“å—ï¼Ÿå»ºè®®ä½¿ç”¨â€˜ä¸‹æ¶â€™ä»£æ›¿åˆ é™¤ã€‚")) {
            currentData.splice(index, 1);
            renderTable();
        }
    }

    // 4. ç›´æ¥åœ¨è¡¨æ ¼é‡Œä¿®æ”¹åå­—å’Œä»·æ ¼
    function updateName(index, val) { currentData[index].name = val; }
    function updatePrice(index, val) { currentData[index].price = parseFloat(val.replace('$','')); }

    // 5. æ ¸å¿ƒï¼šç”Ÿæˆä»£ç 
    function generateCode() {
        const jsonString = JSON.stringify(currentData, null, 4);
        const jsCode = `// è¿™æ˜¯ä½ çš„â€œæ€»æ•°æ®åº“â€ï¼ŒåŒ…å«æ‰€æœ‰ï¼ˆä¸Šæ¶å’Œä¸‹æ¶ï¼‰çš„äº§å“\n// ä»¥åè¯·æŠŠ admin.html ç”Ÿæˆçš„ä»£ç ç²˜è´´è¦†ç›–è¿™é‡Œ\nconst allProducts = ${jsonString};\n\n// è¿™ä¸€è¡Œä»£ç åªâ€œè¿‡æ»¤â€å‡º active: true çš„äº§å“ç»™ index.html ä½¿ç”¨\nconst products = allProducts.filter(p => p.active === true);`;
        
        document.getElementById('outputCode').value = jsCode;
        document.getElementById('outputCode').select();
        document.execCommand("copy"); // å°è¯•è‡ªåŠ¨å¤åˆ¶
        alert("ä»£ç å·²ç”Ÿæˆå¹¶å¤åˆ¶ï¼\nè¯·å» Cursor æ‰“å¼€ products.js å¹¶ç²˜è´´è¦†ç›–ã€‚");
    }

    // åˆå§‹åŒ–
    renderTable();
</script>

</body>
</html>